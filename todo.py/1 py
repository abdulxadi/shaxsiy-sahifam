import mysql.connector
from os import system
system("cls")

try:
    connection = mysql.connector.connect(
        host="localhost",
        user="root",
        password="abdul_xadi_1207",
        database="todo_db"
    )
    print("bazaga ulandi")
except Exception as error:
    print("xatolik", error)
    
    
def kiritish(name, email):  
    sql = "insert into users(name, email) values(%s, %s)"
    param = (name, email)
    cursor = connection.cursor()
    try:
        cursor.execute(sql, param)
        connection.commit()
        print(f"{cursor.rowcount} ta qatorga o'zgartirish kiritildi!!")
    except Exception as error:
        print("xatolik", error)
          
def user_select(id_):
    sql = """select id, name, email, date_format(created_at, "%d.%m.%Y") from users where id > %s"""
    param = (id_,)
    cursor = connection.cursor()
    try:
        cursor.execute(sql, param)
        for row in cursor.fetchall():
            print(f"{row[0]} {row[1]} {row[2]} {row[3]} ")
    except Exception as error:
        print("xatolik", error) 

def delete(id_):
    sql = """delete from users where id = %s""" 
    param = (id_)
    cursor = connection.cursor()
    try:
        cursor.execute(sql, param)
        connection.commit()
        print(f"{cursor.rowcount} ta qatorga o'zgartirish kiritildi!!")
    except Exception as error:
        print("xatolik", error)  

def delete2(id_):
    sql = """delete from todos where user_id = %s""" 
    param = (id_)
    cursor = connection.cursor()
    try:
        cursor.execute(sql, param)
        connection.commit()
        print(f"{cursor.rowcount} ta qatorga o'zgartirish kiritildi!!")
    except Exception as error:
        print("xatolik", error)  
        
def update(id_, new_name):
    sql = """update users set name=%s where id=%s""" 
    param = (new_name, id_)
    cursor = connection.cursor()
    try:
        cursor.execute(sql, param)
        connection.commit()
        print(f"{cursor.rowcount} ta qatorga o'zgartirish kiritildi!!")
    except Exception as error:
        print("xatolik", error)  
        
        
print("""quyidagilardan birini tanlan:
      1.foydalanuvchilarni ko'rish.
      2.yangilash(update).
      3.o'chirish.
      4.qo'shish.
      5.chiqish""")
n = int(input("n ="))

if n == 1:
    id_ = int(input("nechanchi id dan yuqorisini ko'rmoqchisiz!"))
    user_select(id_)
elif n == 2:
    id_ = int(input("id:"))
    name = input("ismingiz: ")
    update(id_, name)
elif n == 3:
    id_ = int(input("id = "))
    delete2(id_)
    delete(id_)
elif n == 4:
    name = input("ismingiz:")
    email = input("email ingiz: ")
    kiritish(name, email)
